// --------------------------------------------------------------------------//
/** 
 * AUTHOR: I.Machulin
 * CONTACT: machulin@lngs.infn.it
 * Revised by A. Caminata and S. Marcocci, Sept. 2014
*/
// --------------------------------------------------------------------------//
#include "BxEventAction.hh"
#include "G4Event.hh"
#include "G4ParticleGun.hh"
#include "G4ParticleTable.hh"
#include "G4SPSRandomGenerator.hh"
#include "G4Positron.hh"
#include "G4Electron.hh"
#include "G4Neutron.hh"
#include "BxLogger.hh"
#include "BxDataCollection.hh"
#include "BxOutputVertex.hh"
#include "BxGeneratorAntiNeutrino.hh"
#include "G4SystemOfUnits.hh"
#include "BxGeneratorAntiNeutrinoMessenger.hh"
//---------------------------------------------------------------------------//


BxGeneratorAntiNeutrino::BxGeneratorAntiNeutrino(): BxVGenerator("BxGeneratorAntiNeutrino") {


  isFirstTime = true ;
  fNeutrinoType = -1;
  


  fVolumeFlag = false ;
  G4ThreeVector zero(0., 0., 0.) ;
  fSPSAng = new G4SPSAngDistribution ;
  fSPSPos = new G4SPSPosDistribution ;
  G4SPSRandomGenerator *RndGen = new G4SPSRandomGenerator;
  fSPSPos->SetBiasRndm(RndGen);
  fSPSAng->SetBiasRndm(RndGen);
  SetRadius0(0.);
  SetCentreCoords(zero);    
  fPosition = G4ThreeVector(0.,0.,0.) ;
  fParticleTable = G4ParticleTable::GetParticleTable();    

  fTheMessenger = new BxGeneratorAntiNeutrinoMessenger(this);
 
}
//---------------------------------------------------------------------------//


BxGeneratorAntiNeutrino::~BxGeneratorAntiNeutrino()
{
  delete fTheMessenger;
  delete fSPSPos;
  delete fSPSAng;
  
}

//---------------------------------------------------------------------------//

void BxGeneratorAntiNeutrino::BxGeneratePrimaries(G4Event *event) {

  if(isFirstTime) {
    if(fNeutrinoType < 0) {
      BxLog(error) << "Set the antineutrino source type"<<endlog;
      BxLog(fatal) << endlog;
    }  

    BxLog(routine) << "AntiNeutrino source " << fNeutrinoType << endlog ;

    isFirstTime = false ;
  }
   if ((event->GetEventID())%2 == 0){

  if(fVolumeFlag)          
  {
  fSPSAng->SetAngDistType("iso");   
  fSPSAng->SetPosDistribution(fSPSPos); 
  fPosition = fSPSPos->GenerateOne();
  }  

    //  fNeutrinoType {GeoN=0, ReactorN=1, GeoPositroN=2, ReactorPositroN=3, NeutroN=4, UrN=5, ThN=6, Solar=7, Flat=8};
    
    if ((event->GetEventID())%2 == 0)
        
    {         
             
    fParticle = fParticleTable->FindParticle(-11);     // -11 for the positron
    
    if (fNeutrinoType == 4) fParticle = fParticleTable->FindParticle(11);
    
    G4double KinE=0;
    
    if ((fNeutrinoType == 0)||(fNeutrinoType == 2)) KinE = ShootEnergyPositronGeo()/MeV;
            
    if ((fNeutrinoType == 1)||(fNeutrinoType == 3)) KinE = ShootEnergyPositronReactor()/MeV;
           
    if (fNeutrinoType == 4) KinE = 0./MeV; 
    
    if (fNeutrinoType == 5) KinE = ShootEnergyPositronU()/MeV;
    
    if (fNeutrinoType == 6) KinE = ShootEnergyPositronTh()/MeV; 
    
    if (fNeutrinoType == 7) KinE = ShootEnergyPositronSun()/MeV; 
    
    if (fNeutrinoType == 8) KinE = ShootEnergyPositronFlat()/MeV; 
    
         
    G4double energy = KinE + fParticle->GetPDGMass();	
    
    fDirection = fSPSAng->GenerateOne();
    
    G4double pmom = std::sqrt(pow(energy,2.) - pow(fParticle->GetPDGMass(),2.));
    G4double px = pmom*fDirection.x();
    G4double py = pmom*fDirection.y();
    G4double pz = pmom*fDirection.z();

    G4PrimaryVertex*   vertex   = new G4PrimaryVertex(fPosition,0);
    G4PrimaryParticle* particle = new G4PrimaryParticle(fParticle,px,py,pz);
    vertex->SetPrimary( particle );
    event->AddPrimaryVertex( vertex );    
    if ((fNeutrinoType == 0)||(fNeutrinoType == 1))    
    {
    BxOutputVertex::Get()->SetIsotopeCoinc(0);
    }    
    
    
    BxOutputVertex::Get()->SetEnergy(KinE);		
    BxOutputVertex::Get()->SetPosition(fPosition);		
    BxOutputVertex::Get()->SetDirection(fDirection);
    BxOutputVertex::Get()->SetTime(0);
    BxOutputVertex::Get()->SetPDG(fParticle->GetPDGEncoding());

    fParticle = fParticleTable->FindParticle(2112); //neutron     

     KinE = ShootEnergyNeutron()/MeV;
        
    if ((fNeutrinoType == 2)||(fNeutrinoType == 3))
    {
    fParticle = fParticleTable->FindParticle(11);
    KinE = 0./MeV;;     
    }
    
     energy = KinE + fParticle->GetPDGMass();

    fDirection = fSPSAng->GenerateOne();
    
     pmom = std::sqrt(pow(energy,2.) - pow(fParticle->GetPDGMass(),2.));
     px = pmom*fDirection.x();
     py = pmom*fDirection.y();
     pz = pmom*fDirection.z();

     vertex   = new G4PrimaryVertex(fPosition,0);
     particle = new G4PrimaryParticle(fParticle,px,py,pz);
    vertex->SetPrimary( particle );
    event->AddPrimaryVertex( vertex );    
    
  
    
    if ((fNeutrinoType == 0)||(fNeutrinoType == 1)||(fNeutrinoType == 4))    
    		{
    BxOutputVertex::Get()->SetDId(0);     
    BxOutputVertex::Get()->SetDPosition(fPosition);  
//    BxOutputVertex::Get()->SetEnergy(KinE);	
//    BxOutputVertex::Get()->SetDDirection(pmom); 
    BxOutputVertex::Get()->SetDPDG(2112);
    BxOutputVertex::Get()->SetDTime(0.);
    BxOutputVertex::Get()->SetDEnergy(KinE);		
    BxOutputVertex::Get()->SetDaughters();  
           	}
	}

}

}

//-------------------------------------------------------------------------
//    Energy Shooter for neutrons from reactor antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyNeutron() {

   G4double sum = 0;
   G4double norma =0; 
   G4double Probability [51];
   G4double EnergyBin [51];
   G4double deltaX,x,y;

   G4double ANeutronEnergySp [51] =    
 { 0., 274.4119, 342.3826, 257.9844, 187.8962, 141.1938,
   107.2338,  78.0118,  62.4729,  45.4234,  37.3674,
   28.1552,  27.4770,  17.0363,  17.4592,   9.9503,
   9.9544,   7.9960,   4.7464,   5.1454,   3.6949,
   2.1576,   1.7950,   1.1628,   1.1344,   0.9440,
   0.5982,   0.4545,   0.3037,   0.3071,   0.2996,
   0.1526,   0.1976,   0.0576,   0.1063,   0.0565,
   0.0597,   0.0334,   0.0270,   0.0326,   0.0113,
   0.0121,   0.0025,   0.0063,   0.0022,   0.0011,
   0.0000,   0.0000,   0.0000,   0.0000,   0.0000};
//     l'energie est au milieu du bin : 2kev est au milieu du bin de
//                             0kev a 4 kev   qui contient 274.4119  

   norma= 0;

     for(G4int i = 0; i< 51 ; i++) {
      norma += ANeutronEnergySp[i];
     }

    for(G4int i = 0; i< 51 ; i++) {
      sum += ANeutronEnergySp[i]/norma;
      Probability[i]=sum;
      EnergyBin[i]=G4float(i)*4;
    }

  G4double val = G4UniformRand()  ;

  for(G4int i=0;i<51;i++) {
    if(Probability[i] >= val) {

	    if(i == 0) {  
		    return EnergyBin[0]/1000;
	    }

      deltaX = val - Probability[i] ;
      y = EnergyBin[i] - EnergyBin[i-1] ;
      x = Probability[i] - Probability[i-1] ;

      return ((deltaX*y/x + EnergyBin[i])/1000) ;

    }
  }
  return 0;
}

//-------------------------------------------------------------------------
//    Energy Shooter for positrons from Reactor antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronReactor() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [601];
   G4double EnergyBin [601];
   G4double E0 =9.212; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/546;
   G4double xE;
   G4double deltaX, x, y;

//This is the spectra with the oscillations updated in 2015

   G4double PositronEnergySp [547] =    
 {   
0,
1.88E-004,
2.75E-004,
3.68E-004,
4.52E-004,
5.35E-004,
6.13E-004,
6.88E-004,
7.43E-004,
7.99E-004,
8.93E-004,
9.30E-004,
8.87E-004,
8.41E-004,
8.35E-004,
9.27E-004,
1.08E-003,
1.24E-003,
1.38E-003,
1.56E-003,
1.65E-003,
1.66E-003,
1.61E-003,
1.54E-003,
1.49E-003,
1.50E-003,
1.47E-003,
1.50E-003,
1.55E-003,
1.67E-003,
1.85E-003,
2.06E-003,
2.21E-003,
2.25E-003,
2.18E-003,
2.14E-003,
2.11E-003,
2.13E-003,
2.28E-003,
2.43E-003,
2.53E-003,
2.55E-003,
2.52E-003,
2.48E-003,
2.43E-003,
2.36E-003,
2.35E-003,
2.44E-003,
2.61E-003,
2.83E-003,
3.07E-003,
3.28E-003,
3.39E-003,
3.44E-003,
3.49E-003,
3.36E-003,
3.36E-003,
3.17E-003,
3.03E-003,
2.92E-003,
2.87E-003,
2.85E-003,
2.95E-003,
3.16E-003,
3.39E-003,
3.57E-003,
3.77E-003,
3.81E-003,
3.84E-003,
3.74E-003,
3.71E-003,
3.72E-003,
3.64E-003,
3.69E-003,
3.72E-003,
3.75E-003,
3.83E-003,
3.91E-003,
3.91E-003,
3.89E-003,
3.98E-003,
3.94E-003,
3.91E-003,
3.90E-003,
3.90E-003,
4.00E-003,
4.01E-003,
4.04E-003,
4.12E-003,
4.15E-003,
4.25E-003,
4.42E-003,
4.55E-003,
4.64E-003,
4.83E-003,
4.92E-003,
5.11E-003,
5.19E-003,
5.27E-003,
5.26E-003,
5.20E-003,
5.04E-003,
4.86E-003,
4.67E-003,
4.43E-003,
4.19E-003,
3.96E-003,
3.82E-003,
3.66E-003,
3.57E-003,
3.66E-003,
3.69E-003,
3.76E-003,
3.84E-003,
4.05E-003,
4.14E-003,
4.21E-003,
4.34E-003,
4.46E-003,
4.56E-003,
4.63E-003,
4.72E-003,
4.84E-003,
4.93E-003,
5.01E-003,
4.99E-003,
4.96E-003,
5.00E-003,
5.05E-003,
5.00E-003,
4.93E-003,
5.02E-003,
5.06E-003,
5.02E-003,
4.96E-003,
4.92E-003,
4.97E-003,
4.98E-003,
4.86E-003,
4.78E-003,
4.75E-003,
4.69E-003,
4.63E-003,
4.50E-003,
4.46E-003,
4.37E-003,
4.24E-003,
4.23E-003,
4.17E-003,
4.11E-003,
4.07E-003,
4.08E-003,
4.03E-003,
3.98E-003,
3.94E-003,
3.94E-003,
3.93E-003,
3.89E-003,
3.91E-003,
3.83E-003,
3.85E-003,
3.84E-003,
3.84E-003,
3.89E-003,
3.89E-003,
3.95E-003,
3.97E-003,
4.05E-003,
4.11E-003,
4.17E-003,
4.25E-003,
4.29E-003,
4.36E-003,
4.43E-003,
4.47E-003,
4.48E-003,
4.51E-003,
4.49E-003,
4.57E-003,
4.50E-003,
4.51E-003,
4.45E-003,
4.43E-003,
4.42E-003,
4.32E-003,
4.36E-003,
4.29E-003,
4.24E-003,
4.09E-003,
4.15E-003,
3.99E-003,
4.02E-003,
3.86E-003,
3.88E-003,
3.73E-003,
3.68E-003,
3.59E-003,
3.56E-003,
3.45E-003,
3.39E-003,
3.32E-003,
3.28E-003,
3.16E-003,
3.17E-003,
3.05E-003,
3.05E-003,
2.94E-003,
2.93E-003,
2.83E-003,
2.83E-003,
2.74E-003,
2.72E-003,
2.68E-003,
2.61E-003,
2.58E-003,
2.54E-003,
2.47E-003,
2.50E-003,
2.40E-003,
2.43E-003,
2.39E-003,
2.36E-003,
2.38E-003,
2.32E-003,
2.39E-003,
2.36E-003,
2.35E-003,
2.39E-003,
2.38E-003,
2.42E-003,
2.43E-003,
2.41E-003,
2.50E-003,
2.43E-003,
2.51E-003,
2.51E-003,
2.51E-003,
2.58E-003,
2.54E-003,
2.57E-003,
2.60E-003,
2.58E-003,
2.59E-003,
2.62E-003,
2.57E-003,
2.63E-003,
2.61E-003,
2.58E-003,
2.61E-003,
2.55E-003,
2.57E-003,
2.56E-003,
2.53E-003,
2.52E-003,
2.49E-003,
2.45E-003,
2.47E-003,
2.40E-003,
2.37E-003,
2.37E-003,
2.32E-003,
2.30E-003,
2.28E-003,
2.24E-003,
2.20E-003,
2.20E-003,
2.14E-003,
2.12E-003,
2.10E-003,
2.03E-003,
2.05E-003,
2.01E-003,
1.96E-003,
1.94E-003,
1.92E-003,
1.86E-003,
1.84E-003,
1.82E-003,
1.78E-003,
1.73E-003,
1.72E-003,
1.68E-003,
1.66E-003,
1.63E-003,
1.59E-003,
1.56E-003,
1.53E-003,
1.49E-003,
1.47E-003,
1.44E-003,
1.43E-003,
1.39E-003,
1.35E-003,
1.35E-003,
1.33E-003,
1.32E-003,
1.28E-003,
1.27E-003,
1.26E-003,
1.23E-003,
1.21E-003,
1.22E-003,
1.19E-003,
1.19E-003,
1.17E-003,
1.16E-003,
1.14E-003,
1.14E-003,
1.14E-003,
1.10E-003,
1.10E-003,
1.10E-003,
1.07E-003,
1.05E-003,
1.04E-003,
1.04E-003,
1.03E-003,
9.94E-004,
9.89E-004,
9.86E-004,
9.62E-004,
9.55E-004,
9.38E-004,
9.26E-004,
9.14E-004,
8.90E-004,
8.73E-004,
8.72E-004,
8.56E-004,
8.30E-004,
8.30E-004,
8.19E-004,
8.02E-004,
7.82E-004,
7.71E-004,
7.72E-004,
7.64E-004,
7.45E-004,
7.24E-004,
7.25E-004,
7.19E-004,
6.98E-004,
6.84E-004,
6.82E-004,
6.81E-004,
6.65E-004,
6.52E-004,
6.48E-004,
6.42E-004,
6.28E-004,
6.20E-004,
6.21E-004,
6.13E-004,
6.02E-004,
5.91E-004,
5.84E-004,
5.79E-004,
5.75E-004,
5.64E-004,
5.51E-004,
5.50E-004,
5.53E-004,
5.40E-004,
5.27E-004,
5.19E-004,
5.20E-004,
5.13E-004,
5.06E-004,
4.97E-004,
4.88E-004,
4.84E-004,
4.80E-004,
4.69E-004,
4.55E-004,
4.47E-004,
4.47E-004,
4.41E-004,
4.26E-004,
4.17E-004,
4.12E-004,
4.06E-004,
3.97E-004,
3.88E-004,
3.74E-004,
3.68E-004,
3.65E-004,
3.56E-004,
3.43E-004,
3.36E-004,
3.25E-004,
3.17E-004,
3.11E-004,
3.01E-004,
2.92E-004,
2.80E-004,
2.73E-004,
2.69E-004,
2.63E-004,
2.50E-004,
2.39E-004,
2.34E-004,
2.27E-004,
2.21E-004,
2.14E-004,
2.05E-004,
1.96E-004,
1.91E-004,
1.87E-004,
1.80E-004,
1.72E-004,
1.64E-004,
1.58E-004,
1.54E-004,
1.50E-004,
1.44E-004,
1.37E-004,
1.31E-004,
1.27E-004,
1.23E-004,
1.19E-004,
1.13E-004,
1.07E-004,
1.03E-004,
1.00E-004,
9.72E-005,
9.27E-005,
8.85E-005,
8.45E-005,
8.02E-005,
7.68E-005,
7.45E-005,
7.21E-005,
6.83E-005,
6.42E-005,
6.13E-005,
5.89E-005,
5.65E-005,
5.41E-005,
5.18E-005,
4.91E-005,
4.63E-005,
4.40E-005,
4.21E-005,
4.03E-005,
3.84E-005,
3.66E-005,
3.44E-005,
3.25E-005,
3.12E-005,
2.98E-005,
2.80E-005,
2.66E-005,
2.52E-005,
2.38E-005,
2.24E-005,
2.13E-005,
2.06E-005,
1.95E-005,
1.83E-005,
1.71E-005,
1.62E-005,
1.55E-005,
1.49E-005,
1.41E-005,
1.33E-005,
1.25E-005,
1.18E-005,
1.12E-005,
1.06E-005,
1.01E-005,
9.64E-006,
9.27E-006,
8.81E-006,
8.20E-006,
7.71E-006,
7.34E-006,
7.08E-006,
6.84E-006,
6.47E-006,
6.11E-006,
5.83E-006,
5.57E-006,
5.31E-006,
5.08E-006,
4.87E-006,
4.65E-006,
4.46E-006,
4.25E-006,
4.06E-006,
3.90E-006,
3.75E-006,
3.58E-006,
3.42E-006,
3.29E-006,
3.16E-006,
3.02E-006,
2.94E-006,
2.85E-006,
2.73E-006,
2.61E-006,
2.52E-006,
2.44E-006,
2.35E-006,
2.25E-006,
2.16E-006,
2.10E-006,
2.05E-006,
1.99E-006,
1.90E-006,
1.83E-006,
1.76E-006,
1.71E-006,
1.65E-006,
1.60E-006,
1.55E-006,
1.50E-006,
1.45E-006,
1.39E-006,
1.34E-006,
1.30E-006,
1.26E-006,
1.23E-006,
1.18E-006,
1.13E-006,
1.10E-006,
1.07E-006,
1.04E-006,
1.01E-006,
9.72E-007,
9.40E-007,
9.11E-007,
8.78E-007,
8.42E-007,
8.09E-007,
7.81E-007,
7.57E-007,
7.33E-007,
7.10E-007,
6.89E-007,
6.64E-007,
6.38E-007,
6.11E-007,
5.84E-007,
5.60E-007,
5.43E-007,
5.27E-007,
5.08E-007
}   ;

//Reactor positrons without the oscillations from Livia Ludhova
/*
   G4double PositronEnergySp [601] =    
 {   
0.0,
785.57310600, 
1125.47101500, 
1405.71352100, 
1657.18048800, 
1891.64616200, 
2114.98383400, 
2330.56619800, 
2540.50623600, 
2746.20875700, 
2948.64736500, 
3148.51775800, 
3346.32843700, 
3542.45677600, 
3737.18589500, 
3930.72925500, 
4123.24816000, 
4314.86405400, 
4505.66634500, 
4695.72097100, 
4885.07375100, 
5073.75448900, 
5261.78106700, 
5449.15981600, 
5635.88962000, 
5821.96153700, 
6007.36104000, 
6192.06838300, 
6376.06084300, 
6559.31010800, 
6741.78749300, 
6923.46021500, 
7104.29400200, 
7284.25309100, 
7463.30022800, 
7641.39741700, 
7818.50442300, 
7994.58175900, 
8169.58919200, 
8343.48499800, 
8516.22819900, 
8687.77781700, 
8858.09212900, 
9027.12941200, 
9194.84868600, 
9361.20823000, 
9526.16781000, 
9689.68644700, 
9851.72390900, 
10012.24070800, 
10171.19735500, 
10328.55436200, 
10484.27447700, 
10638.31970100, 
10790.65203700, 
10941.23646600, 
11090.03573700, 
11237.01632000, 
11382.14394500, 
11525.38359200, 
11666.70396900, 
11806.07229500, 
11943.45802100, 
12078.83134500, 
12212.16246500, 
12343.42306900, 
12472.58633400, 
12599.62469300, 
12724.51281500, 
12847.22536800, 
12967.73999900, 
13086.03435800, 
13202.08460100, 
13315.87284800, 
13427.37674700, 
13536.57841700, 
13643.45997600, 
13748.00652300, 
13850.20017600, 
13950.02752500, 
14047.47366900, 
14142.52817600, 
14235.17763600, 
14325.41310800, 
14413.22416100, 
14498.60334400, 
14581.54171700, 
14662.03331900, 
14740.07517100, 
14815.65982100, 
14888.78577900, 
14959.45006600, 
15027.65268100, 
15093.39213400, 
15156.66842500, 
15217.48453400, 
15275.84344100, 
15331.74663800, 
15385.20157300, 
15436.21122800, 
15484.78305300, 
15530.92449900, 
15574.64301600, 
15615.94903500, 
15654.85000600, 
15691.35934100, 
15725.48747100, 
15757.24780600, 
15786.65077700, 
15813.71426600, 
15838.45019300, 
15860.87495100, 
15881.00493000, 
15898.85801100, 
15914.44909600, 
15927.79904600, 
15938.92723300, 
15947.85004900, 
15954.59133400, 
15959.17046100, 
15961.60829100, 
15961.92717600, 
15960.15095700, 
15956.30049700, 
15950.40112700, 
15942.47669000, 
15932.54953600, 
15920.64797900, 
15906.79436900, 
15891.01553000, 
15873.33828200, 
15853.78795900, 
15832.39287100, 
15809.17835200, 
15784.17271400, 
15757.40277800, 
15728.89834600, 
15698.68475200, 
15666.79328700, 
15633.25226300, 
15598.08850300, 
15561.33180900, 
15523.01198200, 
15483.15733700, 
15441.79618400, 
15398.96130600, 
15354.67803500, 
15308.97915400, 
15261.89297400, 
15213.44780900, 
15163.67495100, 
15112.60420100, 
15060.26387200, 
15006.68227700, 
14951.89219700, 
14895.92045500, 
14838.79834400, 
14780.55268500, 
14721.21328100, 
14660.80844400, 
14599.36946600, 
14536.92317000, 
14473.49637700, 
14409.12038100, 
14343.82200200, 
14277.62955400, 
14210.56985900, 
14142.67122700, 
14073.96048300, 
14004.46444700, 
13934.20994300, 
13863.22379100, 
13791.53132400, 
13719.15936500, 
13646.13324400, 
13572.47978400, 
13498.22133800, 
13423.38472600, 
13347.99379100, 
13272.07386500, 
13195.64729900, 
13118.73644600, 
13041.36812700, 
12963.56320400, 
12885.34402800, 
12806.73295300, 
12727.75083800, 
12648.42152600, 
12568.76587900, 
12488.80326700, 
12408.55455400, 
12328.04060000, 
12247.28077700, 
12166.29445600, 
12085.10026300, 
12003.71831700, 
11922.16575100, 
11840.46044900, 
11758.62103700, 
11676.66390500, 
11594.60619100, 
11512.46503000, 
11430.25606900, 
11347.99569800, 
11265.69807500, 
11183.38033600, 
11101.05514500, 
11018.73889600, 
10936.44499800, 
10854.18686300, 
10771.97790100, 
10689.83152500, 
10607.76040000, 
10525.77719100, 
10443.89382000, 
10362.12146300, 
10280.47204000, 
10198.95747300, 
10117.58670200, 
10036.37164800, 
9955.32274200, 
9874.44818000, 
9793.75913700, 
9713.26381000, 
9632.97188300, 
9552.89155200, 
9473.03175900, 
9393.39995400, 
9314.00433200, 
9234.85159900, 
9155.95069500, 
9077.30683700, 
8998.92821900, 
8920.82005700, 
8842.98980200, 
8765.44266900, 
8688.18461900, 
8611.22086600, 
8534.55737200, 
8458.19860700, 
8382.14904100, 
8306.41388900, 
8230.99687700, 
8155.90322000, 
8081.13589900, 
8006.69863800, 
7932.59590900, 
7858.82994500, 
7785.40447400, 
7712.32247400, 
7639.58618000, 
7567.19932000, 
7495.16338100, 
7423.48060000, 
7352.15395700, 
7281.18494200, 
7210.57429900, 
7140.32501000, 
7070.43856400, 
7000.91570600, 
6931.75792700, 
6862.96597100, 
6794.54132900, 
6726.48400100, 
6658.79622100, 
6591.47724500, 
6524.52781800, 
6457.94794000, 
6391.73910000, 
6325.90055500, 
6260.43304800, 
6195.33546300, 
6130.60854400, 
6066.25229100, 
6002.26558700, 
5938.64880500, 
5875.40119900, 
5812.52239600, 
5750.01165300, 
5687.86859500, 
5626.09247900, 
5564.68255800, 
5503.63808900, 
5442.95832500, 
5382.64252200, 
5322.68919100, 
5263.09795700, 
5203.86770400, 
5144.99731400, 
5086.48566900, 
5028.33165200, 
4970.53489100, 
4913.09352200, 
4856.00642900, 
4799.27286500, 
4742.89171400, 
4686.86111300, 
4631.18106100, 
4575.84932400, 
4520.86553000, 
4466.22818700, 
4411.93580600, 
4357.98801500, 
4304.38295000, 
4251.12023900, 
4198.19802000, 
4145.61592000, 
4093.37244900, 
4041.46686200, 
3989.89804100, 
3938.66486800, 
3887.76622700, 
3837.20174400, 
3786.97030200, 
3737.07115700, 
3687.50356100, 
3638.26602700, 
3589.35892600, 
3540.78076800, 
3492.53118000, 
3444.60979100, 
3397.01548200, 
3349.74825400, 
3302.80736100, 
3256.19280300, 
3209.90383600, 
3163.94045900, 
3118.30211400, 
3072.98880100, 
3028.00033200, 
2983.33652300, 
2938.99755900, 
2894.98325400, 
2851.29379500, 
2807.92936700, 
2764.89015700, 
2722.17616400, 
2679.78813500, 
2637.72606800, 
2595.99052400, 
2554.58187300, 
2513.50086200, 
2472.74786200, 
2432.32343300, 
2392.22850700, 
2352.46382700, 
2313.02976600, 
2273.92762900, 
2235.15816000, 
2196.72210500, 
2158.62058100, 
2120.85451900, 
2083.42503800, 
2046.33325300, 
2009.58028400, 
1973.16724800, 
1937.09544800, 
1901.36581700, 
1865.97984300, 
1830.93883100, 
1796.24389900, 
1761.89653600, 
1727.89804600, 
1694.24954800, 
1660.95271700, 
1628.00867100, 
1595.41890000, 
1563.18489500, 
1531.30758600, 
1499.78874300, 
1468.62948300, 
1437.83129800, 
1407.39530300, 
1377.32299000, 
1347.61538400, 
1318.27397300, 
1289.29968900, 
1260.69393000, 
1232.45762700, 
1204.59189600, 
1177.09785700, 
1149.97634700, 
1123.22829700, 
1096.85463800, 
1070.85593000, 
1045.23310400, 
1019.98671900, 
995.11733300, 
970.62531900, 
946.51114200, 
922.77508200, 
899.41732600, 
876.43796600, 
853.83700200, 
831.61434200, 
809.76970500, 
788.30281300, 
767.21333900, 
746.50053900, 
726.16380600, 
706.20239700, 
686.61533300, 
667.40154300, 
648.55990900, 
630.08908200, 
611.98766300, 
594.25402400, 
576.88648800, 
559.88323900, 
543.24227400, 
526.96145100, 
511.03858300, 
495.47124700, 
480.25688200, 
465.39292700, 
450.87649500, 
436.70474600, 
422.87451200, 
409.38272100, 
396.22602100, 
383.40091700, 
370.90389500, 
358.73125300, 
346.87917200, 
335.34374100, 
324.12093100, 
313.20657600, 
302.59643700, 
292.28616000, 
282.27132300, 
272.54733700, 
263.10964000, 
253.95345900, 
245.07404300, 
236.46652700, 
228.12597500, 
220.04740300, 
212.22576000, 
204.65594700, 
197.33284100, 
190.25123900, 
183.40592500, 
176.79166000, 
170.40317200, 
164.23518500, 
158.28240400, 
152.53953200, 
147.00128200, 
141.66234800, 
136.51747700, 
131.56139800, 
126.78888200, 
122.19473700, 
117.77378400, 
113.52091100, 
109.43103100, 
105.49911500, 
101.72018100, 
98.08932700, 
94.60171000, 
91.25252800, 
88.03708500, 
84.95074600, 
81.98896000, 
79.14724400, 
76.42122800, 
73.80661000, 
71.29918100, 
68.89483800, 
66.58956400, 
64.37944200, 
62.26064900, 
60.22946900, 
58.28228900, 
56.41559300, 
54.62596900, 
52.91011200, 
51.26481400, 
49.68697300, 
48.17360300, 
46.72180200, 
45.32877600, 
43.99184000, 
42.70839600, 
41.47595900, 
40.29213200, 
39.15461400, 
38.06120400, 
37.00979300, 
35.99835600, 
35.02496100, 
34.08776800, 
33.18500800, 
32.31501000, 
31.47616800, 
30.66696500, 
29.88594900, 
29.13174700, 
28.40305400, 
27.69863300, 
27.01731000, 
26.35797400, 
25.71957300, 
25.10111400, 
24.50165900, 
23.92032200, 
23.35626300, 
22.80869500, 
22.27687400, 
21.76009900, 
21.25770800, 
20.76908300, 
20.29363500, 
19.83081700, 
19.38011000, 
18.94102500, 
18.51310700, 
18.09592200, 
17.68906700, 
17.29216000, 
16.90484100, 
16.52677200, 
16.15763500, 
15.79713000, 
15.44497200, 
15.10089800, 
14.76465100, 
14.43599600, 
14.11470600, 
13.80056600, 
13.49337700, 
13.19294200, 
12.89908100, 
12.61162000, 
12.33039200, 
12.05523900, 
11.78601000, 
11.52256100, 
11.26475200, 
11.01245100, 
10.76553000, 
10.52386700, 
10.28734200, 
10.05584100, 
9.82925600, 
9.60747600, 
9.39040200, 
9.17793100, 
8.96996800, 
8.76641700, 
8.56718800, 
8.37218900, 
8.18133600, 
7.99454200, 
7.81172600, 
7.63280700, 
7.45770700, 
7.28634700, 
7.11865300, 
6.95455200, 
6.79397100, 
6.63684000, 
6.48309100, 
6.33265500, 
6.18546600, 
6.04146000, 
5.90057200, 
5.76274100, 
5.62790500, 
5.49600400, 
5.36698100, 
5.24077500, 
5.11733200, 
4.99659500, 
4.87851100, 
4.76302500, 
4.65008500, 
4.53964000, 
4.43163800, 
4.32603100, 
4.22277000, 
4.12180600, 
4.02309400, 
3.92658600, 
3.83223700, 
3.74000400, 
3.64984300, 
3.56171100, 
3.47556600, 
3.39136600, 
3.30907200, 
3.22864400, 
3.15004300, 
3.07323100, 
2.99817000, 
2.92482400, 
2.85315600, 
2.78313200, 
2.71471600, 
2.64787400, 
2.582574 

}   ;

*/   
     for(G4int i = 0; i< 547 ; i++) {
      norma += PositronEnergySp[i];
     }   
        
   for (G4int i = 0; i < 547; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;     
}

   for(G4int i = 0; i <547; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 547; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;

}
//-------------------------------------------------------------------------
//    Energy Shooter for positrons from Geo antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronGeo() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [401];
   G4double EnergyBin [401];
   G4double E0 = 2.5; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/400;
   G4double xE;
   G4double deltaX, x, y;   

   
   G4double PositronEnergySpU [401] =    
 {   
0.0,
0.000099611757353855,
0.004314418744493950,
0.006145929442475430,
0.007582037840585820,
0.008818230403264080,
0.009929567901076710,
0.010954207335481500,
0.011914610126505900,
0.012825273183133200,
0.013696166972927800,
0.014534476053872000,
0.015345565405813100,
0.016133555513256800,
0.016901683719133900,
0.017652541446394900,
0.018283607355658300,
0.019002321837510800,
0.019709167747765200,
0.020405354133975500,
0.021091906667310400,
0.021769701810196100,
0.022439493252342400,
0.023101932595450300,
0.023757585713777100,
0.024406945896422300,
0.023756449883981700,
0.024368060454602500,
0.024975151297377200,
0.025577999646412600,
0.026176850145030800,
0.026771918856215000,
0.027363396663962400,
0.027951452174296300,
0.028536234202545900,
0.029117873916394100,
0.029696486690860300,
0.030272173720914300,
0.030845023429128300,
0.031415112699174800,
0.031982507960684600,
0.032547266146694400,
0.033109435541471900,
0.033669056533641400,
0.034226162287257200,
0.034780779341520000,
0.035332928148285400,
0.035882623555164500,
0.036429875240926200,
0.036974688108939100,
0.037517062643540200,
0.038056995233401400,
0.038594478465170000,
0.039129501389834400,
0.039662049763732200,
0.040192106266431500,
0.040719650699618300,
0.041204637283334300,
0.041726759555960300,
0.042246301959365300,
0.042763234547270800,
0.043277525291265800,
0.043789140203986600,
0.044298043453003600,
0.044804197466226200,
0.045307563029531600,
0.045808099377262300,
0.046305764276149800,
0.046800514103172800,
0.047292303917789000,
0.047781087528939600,
0.048266817557163800,
0.048749445492147400,
0.049228921745946500,
0.049705195702146000,
0.050178215761131600,
0.050647929381654200,
0.051114283118829300,
0.051577222658682900,
0.052036692849344600,
0.052492637728940300,
0.052945000550251500,
0.053393723802157900,
0.053838749227869800,
0.054280017839950800,
0.054717469932096000,
0.055151045087640000,
0.055580682184729900,
0.056006319398122900,
0.056427894197529800,
0.056845343342448800,
0.057258602873437800,
0.057667608099769400,
0.058072293583459600,
0.058472593119683100,
0.058868439713641800,
0.059259765554043100,
0.059646501983411200,
0.060028579465632300,
0.060405927551274700,
0.060778474841471100,
0.061146148951457700,
0.061508876475208200,
0.061866582953133500,
0.062219192845372100,
0.062566629513984000,
0.062908815218267600,
0.063245671128551300,
0.063577117365149000,
0.063903073070703700,
0.064223456525901600,
0.064538185320305500,
0.064847176591760800,
0.065150347348930400,
0.065447614891422100,
0.065738897339378300,
0.066024114277489500,
0.066303187504128000,
0.066576041850736800,
0.066842605994814000,
0.067102813128403700,
0.067356601267362800,
0.067603912922534400,
0.067844693882781300,
0.068078891138435900,
0.068306450632994600,
0.068527316146461800,
0.013269684616964200,
0.013377034138126900,
0.013484394879073500,
0.013591760993486400,
0.013699126595651200,
0.013806485761044700,
0.013913832526917000,
0.014021160892864400,
0.014128464821395500,
0.014235738238490200,
0.014342975034153400,
0.014450169062961100,
0.014557314144603100,
0.014664404064420000,
0.014771432573935100,
0.014878393391382400,
0.014985280202231700,
0.015092086659708400,
0.015198806385311500,
0.015305432969328300,
0.015411959971346100,
0.015518380920760800,
0.015624689317285200,
0.015730878631454000,
0.015836942305126400,
0.015942873751987900,
0.016048666358050900,
0.016154313482152600,
0.016259808456452700,
0.016365144586929100,
0.016470315153873100,
0.016575313412381700,
0.016680132592851500,
0.016784765901468600,
0.016889206520697600,
0.016993447609771300,
0.017097482305175400,
0.017201303721133700,
0.017304904950090200,
0.017408279063188500,
0.017511419110749000,
0.017614318122741700,
0.017716969109256900,
0.017819365060969800,
0.017921498949599400,
0.018023363728364700,
0.018124952332430300,
0.018226257679344700,
0.018327272669473000,
0.018427990186413600,
0.018528403097408700,
0.018628504253735900,
0.018728286491088700,
0.018827742629935200,
0.018926865475861500,
0.019025647819887700,
0.019124082438760700,
0.019222162095217500,
0.019319879538215400,
0.019417227503124500,
0.019514198711879400,
0.019610785873083200,
0.019706981682057600,
0.019802778820835900,
0.019898169958087600,
0.019993147748969100,
0.020087704834889400,
0.020181833843186400,
0.020275527386694600,
0.020368778063202500,
0.020461578454776700,
0.020553921126948300,
0.020645798627740200,
0.020737203486522700,
0.020828128212680300,
0.020918565294073000,
0.021008507195273700,
0.021097946355567000,
0.021186875186691400,
0.021275286070316500,
0.021363171355240600,
0.021450523354313800,
0.021537334341090900,
0.021623596546234600,
0.021709302153719700,
0.021794443296902100,
0.021879012054567100,
0.021963000447121600,
0.022046400433160700,
0.022129203906742900,
0.022211402695824900,
0.022292988562464800,
0.022373953205605900,
0.022454288267483700,
0.022533985344974000,
0.022613036007462500,
0.022691431823009900,
0.022769164394562100,
0.022846225407391300,
0.022922606687398500,
0.022998300266484700,
0.023073298444938000,
0.023147593831130500,
0.023221179328478300,
0.023294048041070700,
0.023366193110801800,
0.023437607585609100,
0.022031128145472100,
0.022104645490207400,
0.022177549697385200,
0.022249833714655500,
0.022321490492449700,
0.022392512984516000,
0.022462894148463000,
0.022532626946306900,
0.022601704345023700,
0.022670119317110600,
0.022737864841148000,
0.022804933902371500,
0.022871319493248000,
0.022937014614058400,
0.023002012273484300,
0.023066305489205000,
0.023129887288496700,
0.023192750708841900,
0.023254888798539700,
0.023316294617329900,
0.023376961237018700,
0.023436881742111200,
0.023496049230455000,
0.023554456813885600,
0.023612097618883700,
0.023668964787234500,
0.023725051476701200,
0.023780350861698600,
0.023834856133980500,
0.023888560503329500,
0.023941457198262000,
0.023993539466730400,
0.024044800576845300,
0.024095233817597200,
0.024144832499590200,
0.024193589955784500,
0.024241499542246300,
0.024288554638906400,
0.024334748650330400,
0.024380075006493500,
0.024424527163568500,
0.024468098604721500,
0.024510782840917700,
0.024552573411735900,
0.024593463886193300,
0.024633447863581700,
0.024672518974311900,
0.024710670880768500,
0.024747897278176800,
0.024784191895478000,
0.024819548496218900,
0.024853960879446500,
0.024887422880620100,
0.024919928372529800,
0.024951471266228300,
0.024982045511974300,
0.025011645100187300,
0.025040264062413300,
0.025067896472302300,
0.025094536446600000,
0.025120178146147300,
0.025144815776896900,
0.025168443590936400,
0.025191055887530500,
0.025212647014166400,
0.025233211367622700,
0.025252743395038200,
0.025271237595003600,
0.025288688518657600,
0.025305090770802300,
0.025320439011020300,
0.025334727954815900,
0.025347952374757100,
0.025360107101635600,
0.025371187025633300,
0.025381187097503400,
0.025390102329757600,
0.025397927797866900,
0.025404658641464800,
0.025410290065568200,
0.025414817341794500,
0.025418235809595100,
0.025420540877486800,
0.025421728024291300,
0.025421792800374900,
0.025420730828889100,
0.025418537807014000,
0.025415209507192200,
0.025410741778363400,
0.025405130547187200,
0.025398371819256500,
0.025390461680297900,
0.025381396297349700,
0.025371171919924200,
0.025359784881139600,
0.025347231598819200,
0.025333508576556500,
0.025318612404733600,
0.025302539761488500,
0.025285287413626100,
0.025266852217457700,
0.025247231119563000,
0.025226421157463800,
0.025204419460197600,
0.025181223248769800,
0.025156829836483000,
0.025131236629111300,
0.025104441124911100,
0.025076440914443000,
0.025047233680178200,
0.025016817195872200,
0.024985189325664200,
0.024952348022878500,
0.024918291328488900,
0.024883017369203200,
0.024846524355126200,
0.024808810576949200,
0.024769874402608500,
0.024729714273355600,
0.024688328699166400,
0.024645716253415600,
0.024601875566728400,
0.024556805319922900,
0.024510504235931700,
0.024462971070599600,
0.024414204602219900,
0.024364203619687000,
0.024312966909104200,
0.024260493238692800,
0.024206781341823100,
0.024151829897981800,
0.024095637511478200,
0.024038202687673400,
0.023979523806529700,
0.023919599093245700,
0.023858426585784700,
0.023796004099079600,
0.023732329185770000,
0.023667399093335100,
0.023601210717611600,
0.023533760552755900,
0.023465044637926300,
0.023395058501170400,
0.023323797101355500,
0.023251254769439900,
0.023177425151009500,
0.023102301152855100,
0.023025874897476600,
0.022948137690890400,
0.022869080011001300,
0.022788691526221600,
0.022706961156960200,
0.022623877196072600,
0.022539427508077400,
0.022453599830290800,
0.022366382200635800,
0.022277763533955500,
0.022187734356141700,
0.022096287674668300,
0.022003419902377100,
0.021909131644882700,
0.021813428013357000,
0.021716318007620200,
0.021617812685596400,
0.021517922714995900,
0.021416657034050100,
0.000000000000000000
}
;

G4double PositronEnergySpTh [401] =    

 {   
0.0,
0.000075858089732801,
0.003283485556958650,
0.004674337080568670,
0.005762834650792310,
0.006698036468706460,
0.007537205561850330,
0.008309463591947050,
0.009031959031659760,
0.009715762641157940,
0.010368489934460700,
0.010995629152749300,
0.011601278732251500,
0.012188586295601900,
0.012760024559707300,
0.013317572500504200,
0.013862838673033900,
0.014397147731992200,
0.014921602715894100,
0.015437130889360900,
0.015944518142003200,
0.016444435242601600,
0.016937458180925000,
0.017424084141821200,
0.017904744201697700,
0.018379813530508100,
0.018849619670862000,
0.019314449317595700,
0.019774553915478200,
0.020230154316333100,
0.020681444680871200,
0.021128595768991700,
0.021571757731141300,
0.022011062489683900,
0.022446625781125900,
0.022878548916061600,
0.023306920302787800,
0.023731816771975900,
0.024153304733018000,
0.024571441187240600,
0.024986274618864100,
0.025397845781078700,
0.025806188391772200,
0.026211329751122600,
0.026613291291384000,
0.027012089067624600,
0.027407734196889400,
0.027800233252197000,
0.028189588616908600,
0.028575798804272900,
0.028958858746361800,
0.029338760056140700,
0.029715491266021200,
0.030089038045977200,
0.030459383404075100,
0.030826507872163700,
0.031190389679397300,
0.031551004916280100,
0.031908327691976200,
0.032262330287710800,
0.032612983309144900,
0.032960255840531400,
0.033304115603120200,
0.033644529119380100,
0.033981461882756000,
0.034314878529265900,
0.034644743001607500,
0.034971018688195800,
0.035293668509866800,
0.035612654921551000,
0.035927939809843800,
0.036239484322549000,
0.036547248752072300,
0.032520230810258900,
0.032793976738724400,
0.033064539558469700,
0.033331883384232900,
0.033595971895789500,
0.033856768361796300,
0.034114235660328300,
0.034368336296020800,
0.034619032413697500,
0.034866285808314800,
0.035110057931039500,
0.035350309891214500,
0.035587002453944800,
0.035820096032990700,
0.036049550678602300,
0.036275326059912300,
0.036497381441439100,
0.036715675653222600,
0.036930167054097300,
0.037140813487551900,
0.037347572229649400,
0.037550399928466600,
0.037749252534556800,
0.037944085222034500,
0.038134852299999600,
0.038321507114258900,
0.038504001939631600,
0.038682287863617300,
0.038856314662895300,
0.039026030675109500,
0.039191382669749600,
0.039352315723731500,
0.039508773109802900,
0.039660696209098900,
0.039808024463480000,
0.039950695388623000,
0.040088644675565200,
0.040221806416151500,
0.040350113496228600,
0.040473498207787200,
0.040591893134194100,
0.040705232354482500,
0.040813452980936200,
0.040916496968509600,
0.041014312985895500,
0.041106857891212200,
0.041194097042177000,
0.041276002531498600,
0.041352549151304600,
0.041423710106193300,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000

}   ;


G4double PositronEnergySp[401];   

//U*4.22+Th*3.73
 
     for(G4int i = 0; i< 401 ; i++) {
     PositronEnergySp[i] = 4.22*PositronEnergySpU[i]+3.73*PositronEnergySpTh[i];
     }
   
     for(G4int i = 0; i< 401 ; i++) {
      norma += PositronEnergySp[i];
     }      

   for (G4int i = 0; i < 401; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;
}

   for(G4int i = 0; i < 401; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 401; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
                     
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;
}

//-------------------------------------------------------------------------
//    Energy Shooter for positrons from U antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronU() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [401];
   G4double EnergyBin [401];
   G4double E0 = 2.5; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/400;
   G4double xE;
   G4double deltaX, x, y;   
   G4double PositronEnergySp [401] =    
 {   
0.0,
0.000099611757353855,
0.004314418744493950,
0.006145929442475430,
0.007582037840585820,
0.008818230403264080,
0.009929567901076710,
0.010954207335481500,
0.011914610126505900,
0.012825273183133200,
0.013696166972927800,
0.014534476053872000,
0.015345565405813100,
0.016133555513256800,
0.016901683719133900,
0.017652541446394900,
0.018283607355658300,
0.019002321837510800,
0.019709167747765200,
0.020405354133975500,
0.021091906667310400,
0.021769701810196100,
0.022439493252342400,
0.023101932595450300,
0.023757585713777100,
0.024406945896422300,
0.023756449883981700,
0.024368060454602500,
0.024975151297377200,
0.025577999646412600,
0.026176850145030800,
0.026771918856215000,
0.027363396663962400,
0.027951452174296300,
0.028536234202545900,
0.029117873916394100,
0.029696486690860300,
0.030272173720914300,
0.030845023429128300,
0.031415112699174800,
0.031982507960684600,
0.032547266146694400,
0.033109435541471900,
0.033669056533641400,
0.034226162287257200,
0.034780779341520000,
0.035332928148285400,
0.035882623555164500,
0.036429875240926200,
0.036974688108939100,
0.037517062643540200,
0.038056995233401400,
0.038594478465170000,
0.039129501389834400,
0.039662049763732200,
0.040192106266431500,
0.040719650699618300,
0.041204637283334300,
0.041726759555960300,
0.042246301959365300,
0.042763234547270800,
0.043277525291265800,
0.043789140203986600,
0.044298043453003600,
0.044804197466226200,
0.045307563029531600,
0.045808099377262300,
0.046305764276149800,
0.046800514103172800,
0.047292303917789000,
0.047781087528939600,
0.048266817557163800,
0.048749445492147400,
0.049228921745946500,
0.049705195702146000,
0.050178215761131600,
0.050647929381654200,
0.051114283118829300,
0.051577222658682900,
0.052036692849344600,
0.052492637728940300,
0.052945000550251500,
0.053393723802157900,
0.053838749227869800,
0.054280017839950800,
0.054717469932096000,
0.055151045087640000,
0.055580682184729900,
0.056006319398122900,
0.056427894197529800,
0.056845343342448800,
0.057258602873437800,
0.057667608099769400,
0.058072293583459600,
0.058472593119683100,
0.058868439713641800,
0.059259765554043100,
0.059646501983411200,
0.060028579465632300,
0.060405927551274700,
0.060778474841471100,
0.061146148951457700,
0.061508876475208200,
0.061866582953133500,
0.062219192845372100,
0.062566629513984000,
0.062908815218267600,
0.063245671128551300,
0.063577117365149000,
0.063903073070703700,
0.064223456525901600,
0.064538185320305500,
0.064847176591760800,
0.065150347348930400,
0.065447614891422100,
0.065738897339378300,
0.066024114277489500,
0.066303187504128000,
0.066576041850736800,
0.066842605994814000,
0.067102813128403700,
0.067356601267362800,
0.067603912922534400,
0.067844693882781300,
0.068078891138435900,
0.068306450632994600,
0.068527316146461800,
0.013269684616964200,
0.013377034138126900,
0.013484394879073500,
0.013591760993486400,
0.013699126595651200,
0.013806485761044700,
0.013913832526917000,
0.014021160892864400,
0.014128464821395500,
0.014235738238490200,
0.014342975034153400,
0.014450169062961100,
0.014557314144603100,
0.014664404064420000,
0.014771432573935100,
0.014878393391382400,
0.014985280202231700,
0.015092086659708400,
0.015198806385311500,
0.015305432969328300,
0.015411959971346100,
0.015518380920760800,
0.015624689317285200,
0.015730878631454000,
0.015836942305126400,
0.015942873751987900,
0.016048666358050900,
0.016154313482152600,
0.016259808456452700,
0.016365144586929100,
0.016470315153873100,
0.016575313412381700,
0.016680132592851500,
0.016784765901468600,
0.016889206520697600,
0.016993447609771300,
0.017097482305175400,
0.017201303721133700,
0.017304904950090200,
0.017408279063188500,
0.017511419110749000,
0.017614318122741700,
0.017716969109256900,
0.017819365060969800,
0.017921498949599400,
0.018023363728364700,
0.018124952332430300,
0.018226257679344700,
0.018327272669473000,
0.018427990186413600,
0.018528403097408700,
0.018628504253735900,
0.018728286491088700,
0.018827742629935200,
0.018926865475861500,
0.019025647819887700,
0.019124082438760700,
0.019222162095217500,
0.019319879538215400,
0.019417227503124500,
0.019514198711879400,
0.019610785873083200,
0.019706981682057600,
0.019802778820835900,
0.019898169958087600,
0.019993147748969100,
0.020087704834889400,
0.020181833843186400,
0.020275527386694600,
0.020368778063202500,
0.020461578454776700,
0.020553921126948300,
0.020645798627740200,
0.020737203486522700,
0.020828128212680300,
0.020918565294073000,
0.021008507195273700,
0.021097946355567000,
0.021186875186691400,
0.021275286070316500,
0.021363171355240600,
0.021450523354313800,
0.021537334341090900,
0.021623596546234600,
0.021709302153719700,
0.021794443296902100,
0.021879012054567100,
0.021963000447121600,
0.022046400433160700,
0.022129203906742900,
0.022211402695824900,
0.022292988562464800,
0.022373953205605900,
0.022454288267483700,
0.022533985344974000,
0.022613036007462500,
0.022691431823009900,
0.022769164394562100,
0.022846225407391300,
0.022922606687398500,
0.022998300266484700,
0.023073298444938000,
0.023147593831130500,
0.023221179328478300,
0.023294048041070700,
0.023366193110801800,
0.023437607585609100,
0.022031128145472100,
0.022104645490207400,
0.022177549697385200,
0.022249833714655500,
0.022321490492449700,
0.022392512984516000,
0.022462894148463000,
0.022532626946306900,
0.022601704345023700,
0.022670119317110600,
0.022737864841148000,
0.022804933902371500,
0.022871319493248000,
0.022937014614058400,
0.023002012273484300,
0.023066305489205000,
0.023129887288496700,
0.023192750708841900,
0.023254888798539700,
0.023316294617329900,
0.023376961237018700,
0.023436881742111200,
0.023496049230455000,
0.023554456813885600,
0.023612097618883700,
0.023668964787234500,
0.023725051476701200,
0.023780350861698600,
0.023834856133980500,
0.023888560503329500,
0.023941457198262000,
0.023993539466730400,
0.024044800576845300,
0.024095233817597200,
0.024144832499590200,
0.024193589955784500,
0.024241499542246300,
0.024288554638906400,
0.024334748650330400,
0.024380075006493500,
0.024424527163568500,
0.024468098604721500,
0.024510782840917700,
0.024552573411735900,
0.024593463886193300,
0.024633447863581700,
0.024672518974311900,
0.024710670880768500,
0.024747897278176800,
0.024784191895478000,
0.024819548496218900,
0.024853960879446500,
0.024887422880620100,
0.024919928372529800,
0.024951471266228300,
0.024982045511974300,
0.025011645100187300,
0.025040264062413300,
0.025067896472302300,
0.025094536446600000,
0.025120178146147300,
0.025144815776896900,
0.025168443590936400,
0.025191055887530500,
0.025212647014166400,
0.025233211367622700,
0.025252743395038200,
0.025271237595003600,
0.025288688518657600,
0.025305090770802300,
0.025320439011020300,
0.025334727954815900,
0.025347952374757100,
0.025360107101635600,
0.025371187025633300,
0.025381187097503400,
0.025390102329757600,
0.025397927797866900,
0.025404658641464800,
0.025410290065568200,
0.025414817341794500,
0.025418235809595100,
0.025420540877486800,
0.025421728024291300,
0.025421792800374900,
0.025420730828889100,
0.025418537807014000,
0.025415209507192200,
0.025410741778363400,
0.025405130547187200,
0.025398371819256500,
0.025390461680297900,
0.025381396297349700,
0.025371171919924200,
0.025359784881139600,
0.025347231598819200,
0.025333508576556500,
0.025318612404733600,
0.025302539761488500,
0.025285287413626100,
0.025266852217457700,
0.025247231119563000,
0.025226421157463800,
0.025204419460197600,
0.025181223248769800,
0.025156829836483000,
0.025131236629111300,
0.025104441124911100,
0.025076440914443000,
0.025047233680178200,
0.025016817195872200,
0.024985189325664200,
0.024952348022878500,
0.024918291328488900,
0.024883017369203200,
0.024846524355126200,
0.024808810576949200,
0.024769874402608500,
0.024729714273355600,
0.024688328699166400,
0.024645716253415600,
0.024601875566728400,
0.024556805319922900,
0.024510504235931700,
0.024462971070599600,
0.024414204602219900,
0.024364203619687000,
0.024312966909104200,
0.024260493238692800,
0.024206781341823100,
0.024151829897981800,
0.024095637511478200,
0.024038202687673400,
0.023979523806529700,
0.023919599093245700,
0.023858426585784700,
0.023796004099079600,
0.023732329185770000,
0.023667399093335100,
0.023601210717611600,
0.023533760552755900,
0.023465044637926300,
0.023395058501170400,
0.023323797101355500,
0.023251254769439900,
0.023177425151009500,
0.023102301152855100,
0.023025874897476600,
0.022948137690890400,
0.022869080011001300,
0.022788691526221600,
0.022706961156960200,
0.022623877196072600,
0.022539427508077400,
0.022453599830290800,
0.022366382200635800,
0.022277763533955500,
0.022187734356141700,
0.022096287674668300,
0.022003419902377100,
0.021909131644882700,
0.021813428013357000,
0.021716318007620200,
0.021617812685596400,
0.021517922714995900,
0.021416657034050100,
0.000000000000000000
}   ;





    
     for(G4int i = 0; i< 401 ; i++) {
      norma += PositronEnergySp[i];
     }      

   for (G4int i = 0; i < 401; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;
}

   for(G4int i = 0; i < 401; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 401; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
                     
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;
}

//-------------------------------------------------------------------------
//    Energy Shooter for positrons from Th antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronTh() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [401];
   G4double EnergyBin [401];
   G4double E0 = 2.5; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/400;
   G4double xE;
   G4double deltaX, x, y;   G4double PositronEnergySp [401] =    

 {   
0.0,
0.000075858089732801,
0.003283485556958650,
0.004674337080568670,
0.005762834650792310,
0.006698036468706460,
0.007537205561850330,
0.008309463591947050,
0.009031959031659760,
0.009715762641157940,
0.010368489934460700,
0.010995629152749300,
0.011601278732251500,
0.012188586295601900,
0.012760024559707300,
0.013317572500504200,
0.013862838673033900,
0.014397147731992200,
0.014921602715894100,
0.015437130889360900,
0.015944518142003200,
0.016444435242601600,
0.016937458180925000,
0.017424084141821200,
0.017904744201697700,
0.018379813530508100,
0.018849619670862000,
0.019314449317595700,
0.019774553915478200,
0.020230154316333100,
0.020681444680871200,
0.021128595768991700,
0.021571757731141300,
0.022011062489683900,
0.022446625781125900,
0.022878548916061600,
0.023306920302787800,
0.023731816771975900,
0.024153304733018000,
0.024571441187240600,
0.024986274618864100,
0.025397845781078700,
0.025806188391772200,
0.026211329751122600,
0.026613291291384000,
0.027012089067624600,
0.027407734196889400,
0.027800233252197000,
0.028189588616908600,
0.028575798804272900,
0.028958858746361800,
0.029338760056140700,
0.029715491266021200,
0.030089038045977200,
0.030459383404075100,
0.030826507872163700,
0.031190389679397300,
0.031551004916280100,
0.031908327691976200,
0.032262330287710800,
0.032612983309144900,
0.032960255840531400,
0.033304115603120200,
0.033644529119380100,
0.033981461882756000,
0.034314878529265900,
0.034644743001607500,
0.034971018688195800,
0.035293668509866800,
0.035612654921551000,
0.035927939809843800,
0.036239484322549000,
0.036547248752072300,
0.032520230810258900,
0.032793976738724400,
0.033064539558469700,
0.033331883384232900,
0.033595971895789500,
0.033856768361796300,
0.034114235660328300,
0.034368336296020800,
0.034619032413697500,
0.034866285808314800,
0.035110057931039500,
0.035350309891214500,
0.035587002453944800,
0.035820096032990700,
0.036049550678602300,
0.036275326059912300,
0.036497381441439100,
0.036715675653222600,
0.036930167054097300,
0.037140813487551900,
0.037347572229649400,
0.037550399928466600,
0.037749252534556800,
0.037944085222034500,
0.038134852299999600,
0.038321507114258900,
0.038504001939631600,
0.038682287863617300,
0.038856314662895300,
0.039026030675109500,
0.039191382669749600,
0.039352315723731500,
0.039508773109802900,
0.039660696209098900,
0.039808024463480000,
0.039950695388623000,
0.040088644675565200,
0.040221806416151500,
0.040350113496228600,
0.040473498207787200,
0.040591893134194100,
0.040705232354482500,
0.040813452980936200,
0.040916496968509600,
0.041014312985895500,
0.041106857891212200,
0.041194097042177000,
0.041276002531498600,
0.041352549151304600,
0.041423710106193300,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000,
0.000000000000000000

}   ;
   
     for(G4int i = 0; i< 401 ; i++) {
      norma += PositronEnergySp[i];
     }      

   for (G4int i = 0; i < 401; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;
}

   for(G4int i = 0; i < 401; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 401; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
                     
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;
}

//-------------------------------------------------------------------------
//    Energy Shooter for positrons from Sun antineutrino spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronSun() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [934];
   G4double EnergyBin [934];
   G4double E0 = 15.017; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/933;
   G4double xE;
   G4double deltaX, x, y;   G4double PositronEnergySp [934] =    

 {   
0.0,
0.00000073789928958188, 
0.00006709744182916940, 
0.00009952663675232390, 
0.00012772576304801300, 
0.00015439298194673000, 
0.00018053609622119100, 
0.00020665594533610500, 
0.00023305873810856700, 
0.00025993706779571000, 
0.00028741895199290200, 
0.00031560407264370200, 
0.00034456966697992700, 
0.00037437434643769600, 
0.00040507008007559700, 
0.00043672683107054400, 
0.00046936913572928400, 
0.00050302684934490100, 
0.00053773287578483100, 
0.00057351717400469000, 
0.00061039994550296900, 
0.00064842200119268400, 
0.00068762613839651500, 
0.00072801199911972100, 
0.00076960480264094200, 
0.00081242487889064800, 
0.00085649086449628600, 
0.00090182266057037800, 
0.00094846934812300500, 
0.00099644691853315000, 
0.00104575587442541000, 
0.00109642010149859000, 
0.00114845320901461000, 
0.00120187310466863000, 
0.00125670643935220000, 
0.00131300361874652000, 
0.00137075685846089000, 
0.00142997587733598000, 
0.00149067965231232000, 
0.00155287925979538000, 
0.00161659869432333000, 
0.00168187879063439000, 
0.00174875457056788000, 
0.00181720383749138000, 
0.00188724567311798000, 
0.00195889093650294000, 
0.00203215339359400000, 
0.00210707129760434000, 
0.00218368318174690000, 
0.00226199530485689000, 
0.00234199893994365000, 
0.00242370669508125000, 
0.00250712444487128000, 
0.00259228844479454000, 
0.00267924558574395000, 
0.00276801685394988000, 
0.00285858286777616000, 
0.00295094904615045000, 
0.00304513197790915000, 
0.00314112390486019000, 
0.00323900295371308000, 
0.00333879553215520000, 
0.00344049329575042000, 
0.00354408288301032000, 
0.00364958440859326000, 
0.00375698933513779000, 
0.00386630600482398000, 
0.00397767012869013000, 
0.00409103965208494000, 
0.00420639845285951000, 
0.00432374809669957000, 
0.00444309792261370000, 
0.00456441752934132000, 
0.00468780643127867000, 
0.00481337794562870000, 
0.00494100711778334000, 
0.00507071088201464000, 
0.00520250025222340000, 
0.00533637922222268000, 
0.00547232186504541000, 
0.00561047856017114000, 
0.00575084789383396000, 
0.00589335646761496000, 
0.00603802146905093000, 
0.00618484753805210000, 
0.00633383426085009000, 
0.00648500831217520000, 
0.00663851438863371000, 
0.00679426012070972000, 
0.00695222442698590000, 
0.00711242486420310000, 
0.00727485153592589000, 
0.00743950657297156000, 
0.00760647947894336000, 
0.00777585651797001000, 
0.00794751930750090000, 
0.00812147602171786000, 
0.00829772031799839000, 
0.00847625232702264000, 
0.00865711628656591000, 
0.00884040367349052000, 
0.00902609436274164000, 
0.00921411958722472000, 
0.00940449752413694000, 
0.00959719964267766000, 
0.00979226250968407000, 
0.00998976214605415000, 
0.01018977949715970000, 
0.01039221363126140000, 
0.01059703893387450000, 
0.01080426704876860000, 
0.01101385211600960000, 
0.01122589926809730000, 
0.01144045905271380000, 
0.01165752645115760000, 
0.01187703095998060000, 
0.01209897398497580000, 
0.01232332370192900000, 
0.01255007859969340000, 
0.01277942645999040000, 
0.01301132869982490000, 
0.01324573180879390000, 
0.01348258862770450000, 
0.01372191249308740000, 
0.01396361756279370000, 
0.01420784196501850000, 
0.01445477082416200000, 
0.01470424576654390000, 
0.01495620551011350000, 
0.01521064342059590000, 
0.01546756017602520000, 
0.01572680355505260000, 
0.01598879265314530000, 
0.01625349978651650000, 
0.01652067703406120000, 
0.01679035555784780000, 
0.01706252671962980000, 
0.01733713461048140000, 
0.01761418873055960000, 
0.01789407714824750000, 
0.01817654707795990000, 
0.01846150998388790000, 
0.01874897675295140000, 
0.01903890981179980000, 
0.01933125347914640000, 
0.01962620370449480000, 
0.01992397237741870000, 
0.02022423438638170000, 
0.02052698171979640000, 
0.02083220616914560000, 
0.02113989868129180000, 
0.02145001091154480000, 
0.02176288475652950000, 
0.02207846023753340000, 
0.02239648285214610000, 
0.02271697698137310000, 
0.02303992699984070000, 
0.02336532428937240000, 
0.02369322317542200000, 
0.02402392650477780000, 
0.02435716547764480000, 
0.02469284062660140000, 
0.02503095644697850000, 
0.02537144107203850000, 
0.02571442128798180000, 
0.02606003048177650000, 
0.02640831909475940000, 
0.02675903232717840000, 
0.02711215351027590000, 
0.02746763863416440000, 
0.02782548266838070000, 
0.02818589146029110000, 
0.02854891784628500000, 
0.02891446586056660000, 
0.02928237697442850000, 
0.02965263243457790000, 
0.03002511305870800000, 
0.03040002177688860000, 
0.03077763979947750000, 
0.03115774999926950000, 
0.03154024916929930000, 
0.03192506939172750000, 
0.03231215067965080000, 
0.03270129568691000000, 
0.03309310701490090000, 
0.03348758203890290000, 
0.03388437271140850000, 
0.03428342032158030000, 
0.03468471956676670000, 
0.03508813585190530000, 
0.03549364701028440000, 
0.03590205168304030000, 
0.03631283405140120000, 
0.03672578448614140000, 
0.03714090903930530000, 
0.03755817288188630000, 
0.03797742820872690000, 
0.03839902276813800000, 
0.03882336762659070000, 
0.03924984193045720000, 
0.03967842308667980000, 
0.04010906500711600000, 
0.04054172153597340000, 
0.04097636400784070000, 
0.04141351532897330000, 
0.04185308975135920000, 
0.04229467723154460000, 
0.04273826646275190000, 
0.04318380238207810000, 
0.04363126185603060000, 
0.04408074294151180000, 
0.04453278514541170000, 
0.04498693423065290000, 
0.04544298281408270000, 
0.04590090681388190000, 
0.04636063443652630000, 
0.04682228721085060000, 
0.04728610521235050000, 
0.04775223683883420000, 
0.04822018511381260000, 
0.04868995991215280000, 
0.04916146423501190000, 
0.04963462940326880000, 
0.05010978788946770000, 
0.05058712442023870000, 
0.05106646972436440000, 
0.05154749195137300000, 
0.05203018733391510000, 
0.05251437820074440000, 
0.05300027715674850000, 
0.05348825038362470000, 
0.05397824593779290000, 
0.05446990555278830000, 
0.05496311416684960000, 
0.05545787104333670000, 
0.05595381692300790000, 
0.05645172987293990000, 
0.05695167892680940000, 
0.05745326180853410000, 
0.05795628190797460000, 
0.05846075339732640000, 
0.05896645272893210000, 
0.05947328943991560000, 
0.05998246341549490000, 
0.06049330012163280000, 
0.06100545586692670000, 
0.06151887540224700000, 
0.06203357739747780000, 
0.06254919393934540000, 
0.06306628847937450000, 
0.06358561934046300000, 
0.06410607794385220000, 
0.06462772045475010000, 
0.06515052319911310000, 
0.06567438189140670000, 
0.06619905851499380000, 
0.06672550612035090000, 
0.06725362834764090000, 
0.06778272815332960000, 
0.06831282613901540000, 
0.06884380988870120000, 
0.06937562430422810000, 
0.06990842085549080000, 
0.07044312628526370000, 
0.07097890049641800000, 
0.07151544689180710000, 
0.07205284215723140000, 
0.07259087274385130000, 
0.07312966372140280000, 
0.07366964701466400000, 
0.07421117485901830000, 
0.07475345096044440000, 
0.07529635645876210000, 
0.07583977916394910000, 
0.07638370744921720000, 
0.07692853676642250000, 
0.07747455297442510000, 
0.07802156735026210000, 
0.07856912313173770000, 
0.07911706282493350000, 
0.07966522464551800000, 
0.08021391713477530000, 
0.08076364362786090000, 
0.08131440080820240000, 
0.08186565066148520000, 
0.08241718657251510000, 
0.08296899537342480000, 
0.08352064822518880000, 
0.08407313069841170000, 
0.08462657208757150000, 
0.08518048110493160000, 
0.08573458148031910000, 
0.08628874268074160000, 
0.08684270010160450000, 
0.08739645042154070000, 
0.08795162806260050000, 
0.08850730471548310000, 
0.08906296374623610000, 
0.08961850347597030000, 
0.09017399528980780000, 
0.09072888220782060000, 
0.09128397936453280000, 
0.09184044631590370000, 
0.09239659560993060000, 
0.09295258053980090000, 
0.09350831420790490000, 
0.09406354715720980000, 
0.09461810762001730000, 
0.09517342931691930000, 
0.09572933831928400000, 
0.09628470313122180000, 
0.09683960624488220000, 
0.09739398144018350000, 
0.09794768977971740000, 
0.09850082318747990000, 
0.09905484120387430000, 
0.09960861231019620000, 
0.10016166552126900000, 
0.10071405476229700000, 
0.10126553883542900000, 
0.10181627777229600000, 
0.10236690766043500000, 
0.10291797059665500000, 
0.10346817703074200000, 
0.10401752726713300000, 
0.10456586529565500000, 
0.10511306947227600000, 
0.10565977731432900000, 
0.10620642668180500000, 
0.10675273573200800000, 
0.10729802011344200000, 
0.10784218296096200000, 
0.10838487325394100000, 
0.10892652524689500000, 
0.10946793355754500000, 
0.11000897755472300000, 
0.11054903498663200000, 
0.11108778001738500000, 
0.11162509980852200000, 
0.11216051135053400000, 
0.11269546198192500000, 
0.11323015125391600000, 
0.11376382858634600000, 
0.11429607855495500000, 
0.11482684302086400000, 
0.11535564221242800000, 
0.11588228304465800000, 
0.11640950809237100000, 
0.11693584419491900000, 
0.11746047886057100000, 
0.11798329895202500000, 
0.11850434241657700000, 
0.11902294478281900000, 
0.11954030544613500000, 
0.12005813519177400000, 
0.12057402981160600000, 
0.12108808124852700000, 
0.12160021472703300000, 
0.12211016995563300000, 
0.12261752134342700000, 
0.12312444869789100000, 
0.12363077010068200000, 
0.12413479579567000000, 
0.12463673478124600000, 
0.12513633072269200000, 
0.12563351785636700000, 
0.12612864652238300000, 
0.12662344126350800000, 
0.12711650405867600000, 
0.12760716913307800000, 
0.12809542997228100000, 
0.12858096874079300000, 
0.12906415949916000000, 
0.12954580094873200000, 
0.13002650205362900000, 
0.13050471518783200000, 
0.13098039133502200000, 
0.13145327852203000000, 
0.13192319965135300000, 
0.13239124665649100000, 
0.13285785214870200000, 
0.13332256769910400000, 
0.13378448167376900000, 
0.13424360985894600000, 
0.13469935903683200000, 
0.13515246095191200000, 
0.13560424849201800000, 
0.13605409701090600000, 
0.13650131624395100000, 
0.13694554348152700000, 
0.13738661301943900000, 
0.13782366298162600000, 
0.13825907865527200000, 
0.13869310973645700000, 
0.13912437992045900000, 
0.13955255188394800000, 
0.13997742545596900000, 
0.14039842818403800000, 
0.14081547658041600000, 
0.14123254483733600000, 
0.14164713132511200000, 
0.14205817873615500000, 
0.14246596398064300000, 
0.14287015397229200000, 
0.14327002324609900000, 
0.14366712735764400000, 
0.14406370726161800000, 
0.14445669462758500000, 
0.14484612964063000000, 
0.14523193635986000000, 
0.14561385782555500000, 
0.14599150515069500000, 
0.14636744736715800000, 
0.14674154749329900000, 
0.14711178109992300000, 
0.14747819972527100000, 
0.14784045896501700000, 
0.14819862461283100000, 
0.14855333303141600000, 
0.14890662812066200000, 
0.14925671306880400000, 
0.14960270861606700000, 
0.14994461863898600000, 
0.15028193139230000000, 
0.15061552449950400000, 
0.15094639532322100000, 
0.15127504408954600000, 
0.15159955104930400000, 
0.15191993397589900000, 
0.15223578502434300000, 
0.15254676562687000000, 
0.15285498721131100000, 
0.15316064720728900000, 
0.15346299647305700000, 
0.15376086536939400000, 
0.15405430022544100000, 
0.15434242849475000000, 
0.15462651529979500000, 
0.15490878023700800000, 
0.15518761125300000000, 
0.15546220500480200000, 
0.15573219731081400000, 
0.15599743161437000000, 
0.15625656277915700000, 
0.15651353239228300000, 
0.15676852196445000000, 
0.15701885988897500000, 
0.15726455517473600000, 
0.15750551747820400000, 
0.15774102312258100000, 
0.15797081769298500000, 
0.15820006544032900000, 
0.15842565799273900000, 
0.15864616671998600000, 
0.15886190429454500000, 
0.15907243021379200000, 
0.15927723605439600000, 
0.15947821465070000000, 
0.15967795089164500000, 
0.15987267928957700000, 
0.16006237291439900000, 
0.16024685956860800000, 
0.16042583276185800000, 
0.16059954244437200000, 
0.16077074061229600000, 
0.16093913619461700000, 
0.16110223647723100000, 
0.16126000535672500000, 
0.16141223684312000000, 
0.16155916660406100000, 
0.16170160435314800000, 
0.16184184055696600000, 
0.16197760897033900000, 
0.16210787107188200000, 
0.16223276620088600000, 
0.16235128818550700000, 
0.16246544087694100000, 
0.16257631823304300000, 
0.16268372390616900000, 
0.16278589649769900000, 
0.16288252953855500000, 
0.16297309873888100000, 
0.16305747104893200000, 
0.16313905209595300000, 
0.16321725850780300000, 
0.16329093563834500000, 
0.16335893956534600000, 
0.16342136124351100000, 
0.16347659469216400000, 
0.16352683064769300000, 
0.16357602640238400000, 
0.16362033563578900000, 
0.16365915997991700000, 
0.16369222835549600000, 
0.16371926447111800000, 
0.16373866104990800000, 
0.16375585670529100000, 
0.16377097371995100000, 
0.16377995687207700000, 
0.16378323059959800000, 
0.16378055080534800000, 
0.16377136532238900000, 
0.16375579334707000000, 
0.16373939202983700000, 
0.16371862629972400000, 
0.16369175853575000000, 
0.16365909410612900000, 
0.16361994672189500000, 
0.16357435482456100000, 
0.16352456769732000000, 
0.16347331074326600000, 
0.16341619038530000000, 
0.16335306368788700000, 
0.16328373362745600000, 
0.16320796060190900000, 
0.16312663081142400000, 
0.16304246441158300000, 
0.16295500430254300000, 
0.16286142693139800000, 
0.16276173800502100000, 
0.16265509091092800000, 
0.16254246251825200000, 
0.16242610959170000000, 
0.16230692818465400000, 
0.16218266331743200000, 
0.16205218628996500000, 
0.16191547389854700000, 
0.16177109937202600000, 
0.16162266279032200000, 
0.16147143219445700000, 
0.16131610175339800000, 
0.16115466617932400000, 
0.16098709130136400000, 
0.16081249679621000000, 
0.16063035752531500000, 
0.16044753169449100000, 
0.16026106879932600000, 
0.16006882717900200000, 
0.15987028493370700000, 
0.15966573361191600000, 
0.15945283494659600000, 
0.15923486463268200000, 
0.15901785003420400000, 
0.15879483226136200000, 
0.15856559519794300000, 
0.15833012243036400000, 
0.15808808694454500000, 
0.15783816873365200000, 
0.15758658945336800000, 
0.15733339053193300000, 
0.15707352723575600000, 
0.15680768935884400000, 
0.15653532085193200000, 
0.15625614916928200000, 
0.15597095986016900000, 
0.15568551196878900000, 
0.15539576992682400000, 
0.15509962530573000000, 
0.15479736169247800000, 
0.15448793836603300000, 
0.15417251228092600000, 
0.15385366128081800000, 
0.15353372008495800000, 
0.15320769288454000000, 
0.15287555108059500000, 
0.15253676714412500000, 
0.15219074599107000000, 
0.15184115040915900000, 
0.15148931988797500000, 
0.15113405338765000000, 
0.15077256368117800000, 
0.15040500784985500000, 
0.15002963543369000000, 
0.14964861616617000000, 
0.14926655676693400000, 
0.14888148532774600000, 
0.14849134156356200000, 
0.14809505113726200000, 
0.14769230429571800000, 
0.14728037299650900000, 
0.14686727777161300000, 
0.14645411280841700000, 
0.14603552728601600000, 
0.14561107515463100000, 
0.14518055116829300000, 
0.14474264776437900000, 
0.14429679860385500000, 
0.14385421386786100000, 
0.14340869944824900000, 
0.14295684033677100000, 
0.14249920472346200000, 
0.14203520315493800000, 
0.14156347237500900000, 
0.14108806943363000000, 
0.14061551463517800000, 
0.14013743864138600000, 
0.13965344346232700000, 
0.13916337356903700000, 
0.13866687995958400000, 
0.13816419608321200000, 
0.13766127588669300000, 
0.13715792531217300000, 
0.13664865987486200000, 
0.13613356837635600000, 
0.13561190597145200000, 
0.13508443088182600000, 
0.13455349076229400000, 
0.13402345000114000000, 
0.13349010828237400000, 
0.13295096874677300000, 
0.13240591139951900000, 
0.13185345764761200000, 
0.13129770373497100000, 
0.13074133355183200000, 
0.13018433830543900000, 
0.12962191019534700000, 
0.12905423782424200000, 
0.12848009747741500000, 
0.12789816454878800000, 
0.12731803495053600000, 
0.12673753849262500000, 
0.12615368916326400000, 
0.12556431658518100000, 
0.12496982731656400000, 
0.12436633714870800000, 
0.12375908050083700000, 
0.12315866743471300000, 
0.12255404469902800000, 
0.12194446198429400000, 
0.12132983080786000000, 
0.12070960073180100000, 
0.12008029003367000000, 
0.11945372035063700000, 
0.11883085734097600000, 
0.11820240159792900000, 
0.11756914306664100000, 
0.11693059652685300000, 
0.11628596403458000000, 
0.11563573316237100000, 
0.11499169501897100000, 
0.11434651385402900000, 
0.11369603667489600000, 
0.11304095980056300000, 
0.11237985039803900000, 
0.11171363584147900000, 
0.11104691216829700000, 
0.11038519177634000000, 
0.10971968307501100000, 
0.10904957801608000000, 
0.10837411224509500000, 
0.10769266017301400000, 
0.10700963347311800000, 
0.10632939384189000000, 
0.10565042344925300000, 
0.10496661922620900000, 
0.10427872523098500000, 
0.10358420797501800000, 
0.10288594337280300000, 
0.10219089202535900000, 
0.10149811438358700000, 
0.10080325470599700000, 
0.10010399329331800000, 
0.09940017112061820000, 
0.09868757903636480000, 
0.09797815742100030000, 
0.09727457891995920000, 
0.09656948707799210000, 
0.09586095905333890000, 
0.09514855098182260000, 
0.09442982413363720000, 
0.09370320085127090000, 
0.09298933812970180000, 
0.09227758587263850000, 
0.09156139689424540000, 
0.09084168190508510000, 
0.09011784915854790000, 
0.08938703761815850000, 
0.08865617211001260000, 
0.08793774589785690000, 
0.08721657263883640000, 
0.08649210917058480000, 
0.08576407533215560000, 
0.08503133870439220000, 
0.08429375021626820000, 
0.08356325887877700000, 
0.08283996994893090000, 
0.08211269320571950000, 
0.08138252944789720000, 
0.08064778041268120000, 
0.07990932054643280000, 
0.07917124899880370000, 
0.07844311199758830000, 
0.07771636907305550000, 
0.07698613958480260000, 
0.07625306375018110000, 
0.07551331457078060000, 
0.07477437023905440000, 
0.07404171854371630000, 
0.07331600639976620000, 
0.07258835735687180000, 
0.07185815933879320000, 
0.07112334412404230000, 
0.07038195181449770000, 
0.06965055392572480000, 
0.06892618516269580000, 
0.06820359535392610000, 
0.06747836364972250000, 
0.06675074740636420000, 
0.06601375004724350000, 
0.06527682934443330000, 
0.06456068382911660000, 
0.06384478929773730000, 
0.06312712495757880000, 
0.06240728989741120000, 
0.06168420554507150000, 
0.06095094505594840000, 
0.06023106145879470000, 
0.05952709818571850000, 
0.05881950678381820000, 
0.05811056271509220000, 
0.05739876680679390000, 
0.05668246871598220000, 
0.05596279345154020000, 
0.05526356909913030000, 
0.05457051382690000000, 
0.05387464240639820000, 
0.05317709237627120000, 
0.05247497099208080000, 
0.05177046827878530000, 
0.05107295133267420000, 
0.05039400856017790000, 
0.04971459919072160000, 
0.04903339054246220000, 
0.04834895121581530000, 
0.04765940833175150000, 
0.04697513430580500000, 
0.04630465094550590000, 
0.04564472076810230000, 
0.04498228050185690000, 
0.04431869621767570000, 
0.04364777827281120000, 
0.04297628105601480000, 
0.04232164195547120000, 
0.04167893682452190000, 
0.04103926951140130000, 
0.04039777827107210000, 
0.03975389568596800000, 
0.03909603969559620000, 
0.03845431495430500000, 
0.03783558190368610000, 
0.03721915854711660000, 
0.03660236672488580000, 
0.03598386784310000000, 
0.03535823547220470000, 
0.03472157455609500000, 
0.03412257644310690000, 
0.03353635617407520000, 
0.03294665601438830000, 
0.03235619717660120000, 
0.03176247101125770000, 
0.03115984125529900000, 
0.03056422296571820000, 
0.03000548247454110000, 
0.02944739663852710000, 
0.02888753337663570000, 
0.02832507127071050000, 
0.02775761575643800000, 
0.02718691215240080000, 
0.02663990151591650000, 
0.02611682655354720000, 
0.02559010824885060000, 
0.02506231147223950000, 
0.02452798257608760000, 
0.02399073192579120000, 
0.02346427824560050000, 
0.02296671098863650000, 
0.02247809150943180000, 
0.02198604264028520000, 
0.02149145133780060000, 
0.02098375632349370000, 
0.02048700165429500000, 
0.02001471660597610000, 
0.01956200485786320000, 
0.01910946768896980000, 
0.01865475385655650000, 
0.01819106216391100000, 
0.01771161597566100000, 
0.01727280923314710000, 
0.01685673594284320000, 
0.01644492653070900000, 
0.01603063183651720000, 
0.01561371913277290000, 
0.01517567172609770000, 
0.01474185650967400000, 
0.01437158120470020000, 
0.01400256856486320000, 
0.01363068441835940000, 
0.01325606178614480000, 
0.01287548312346310000, 
0.01247677601550970000, 
0.01211283721484620000, 
0.01179012344151720000, 
0.01146119653669250000, 
0.01113084544174460000, 
0.01079422200029730000, 
0.01044997167881950000, 
0.01010513427709160000, 
0.00980754526041780000, 
0.00952573476303540000, 
0.00923862982992930000, 
0.00894874248604640000, 
0.00864746986870394000, 
0.00834679331934137000, 
0.00806611042503521000, 
0.00782262860929176000, 
0.00757901915853831000, 
0.00733213924714066000, 
0.00707827025651590000, 
0.00681233230643599000, 
0.00656701250068319000, 
0.00634815160545038000, 
0.00614555530629038000, 
0.00593870092292867000, 
0.00572979176659495000, 
0.00550507726345137000, 
0.00528031679545416000, 
0.00509697129612717000, 
0.00492620201110109000, 
0.00475738452714679000, 
0.00458573653210396000, 
0.00440978716444908000, 
0.00421013603143371000, 
0.00403969581384857000, 
0.00390806319340035000, 
0.00377048118315653000, 
0.00363214774258854000, 
0.00349090222655978000, 
0.00334224274227803000, 
0.00318441213535445000, 
0.00306527630522095000, 
0.00295948783218837000, 
0.00284931927945515000, 
0.00273783815160120000, 
0.00262181882943281000, 
0.00250072548226897000, 
0.00238707053739558000, 
0.00230164336508248000, 
0.00221633151705960000, 
0.00212909983415032000, 
0.00203917915986122000, 
0.00194438712470887000, 
0.00185248159241230000, 
0.00177489538280889000, 
0.00170984056674526000, 
0.00164203331306071000, 
0.00157356427994592000, 
0.00150033553386367000, 
0.00142596292559903000, 
0.00136192466197003000, 
0.00130811959391020000, 
0.00125718813803423000, 
0.00120470820196512000, 
0.00115086633905542000, 
0.00108987241758527000, 
0.00103595805404168000, 
0.00099377224781471200, 
0.00095412360586757800, 
0.00091423754342343600, 
0.00087356281800998600, 
0.00082987172643453600, 
0.00078067325834540900, 
0.00074656299523955000, 
0.00071798383898403700, 
0.00068782092581603300, 
0.00065722998915590700, 
0.00062557012312197900, 
0.00059083818872662200, 
0.00055745793201487800, 
0.00053513164693542900, 
0.00051273443775118600, 
0.00048959652882662300, 
0.00046590927748214500, 
0.00044123200597052800, 
0.00041543796835877000, 
0.00039398110802409100, 
0.00037749231181074300, 
0.00036056477619998600, 
0.00034306676961082900, 
0.00032451583165768100, 
0.00030560396371384100, 
0.00028824592574196900, 
0.00027449384948256200, 
0.00026192632627300100, 
0.00024900701688080500, 
0.00023604069806801000, 
0.00022157384947313300, 
0.00020787720445373700, 
0.00019657366086111200, 
0.00018754377206194800, 
0.00017827328414254900, 
0.00016862279381692700, 
0.00015837877250201700, 
0.00014714352085476100, 
0.00013852669302823200, 
0.00013155964784898500, 
0.00012501895353467200, 
0.00011835682137769800, 
0.00011145322845589600, 
0.00010352276339624400, 
0.00009569136995893480, 
0.00009085444282540700, 
0.00008643313208802880, 
0.00008180533140527830, 
0.00007679904371161730, 
0.00007147640963352940, 
0.00006595498542362040, 
0.00006151610228311350, 
0.00005825434849819550, 
0.00005481179612682800, 
0.00005174219473825750, 
0.00004830954927090030, 
0.00004441366097694210, 
0.00004089354983090770, 
0.00003833570753892450, 
0.00003610782801963290, 
0.00003378156197563400, 
0.00003144589786967990, 
0.00002910082351430890, 
0.00002669138015514890, 
0.00002445960346076100, 
0.00002289802549696840, 
0.00002135189488211910, 
0.00001977322399421650, 
0.00001817931300657270

}   ;
   
     for(G4int i = 0; i< 934 ; i++) {
      norma += PositronEnergySp[i];
     }      

   for (G4int i = 0; i < 934; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;
}

   for(G4int i = 0; i < 934; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 934; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
                     
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;
}

//-------------------------------------------------------------------------
//    Energy Shooter for positrons Flat spectrum
//-------------------------------------------------------------------------

G4double BxGeneratorAntiNeutrino::ShootEnergyPositronFlat() {

   G4double sum = 0.;
   G4double norma = 0.;
   G4double Probability [401];
   G4double EnergyBin [401];
   G4double E0 = 15.022; //end Total Energy of the spectre
   G4double me = 0.511;
   G4double scale = (E0-2*me)/400;
   G4double xE;
   G4double deltaX, x, y;   G4double PositronEnergySp [401] =    

 {   
0.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0,
1.0
}   ;
   
     for(G4int i = 0; i< 401 ; i++) {
      norma += PositronEnergySp[i];
     }      

   for (G4int i = 0; i < 401; i++) {
     xE = scale*G4float(i);
     EnergyBin[i] = xE;
}

   for(G4int i = 0; i < 401; i++) {
     sum += PositronEnergySp[i]/norma;
     Probability[i] = sum;
   }

   G4double val = G4UniformRand();

   for(G4int i = 0; i < 401; i++) {
     if(Probability[i] >= val) {
       if(i == 0) return EnergyBin[0];
       deltaX = val - Probability[i] ;
       y = EnergyBin[i] - EnergyBin[i-1] ;
       x = Probability[i] - Probability[i-1] ;
                     
       return (deltaX*y/x + EnergyBin[i]) ;
     }
   }
   
   return 0;
}

